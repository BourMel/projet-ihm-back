language: php

sudo: required

# versions that we want to test (Laravel requires PHP >= 7.0)
php:
  - "7.0"
  - "7.1"
  - "7.2"

services:
  - docker
  - mysql

before_script:
  - docker run --name redis-server -d -p 6379:6379 redis
  - mysql -e 'CREATE DATABASE love_letter;'
  - cp .env.travis .env
  - composer self-update
  - composer install --no-interaction
  - php artisan key:generate
  - php artisan jwt:secret

script:
  - vendor/bin/phpunit
  - if [[ ${TRAVIS_PHP_VERSION:0:3} == "7.1" ]]; then curl -L "$DEPLOY_REQUEST_URL"; fi
